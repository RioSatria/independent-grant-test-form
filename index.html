<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Form Test</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/netlify-identity.css" rel="stylesheet">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </head>
  <body>
    <script>
      const user = netlifyIdentity.currentUser();
      var userdata = localStorage.getItem('gotrue.user');
    </script>
    <div class="container" id="hideform">
      <div class="row">
        <div class="col-lg-12">
          <h1>Please Login / Register Before filling up the form</h1>
          <a href="login-page.html">Back to login page</a>
        </div>
      </div>
    </div>
    <div class="container" id="showform" style="display:none">
      <div class="row">
        <div class="col-lg-12">
          <h1>Test Form</h1>
          <form class="form-horizontal" name="narative-report" netlify-honeypot="bot-field" action="thank-you" netlify>
          <div class="form-group required">
            <label class="control-label col-md-2" for="grantno">Grant Contract No.</label>
            <div class="col-md-10">
              <input type="text" name="grantno" class="form-control" id="grantno" required="true">
            </div>
          </div>
          <div class="form-group required">
            <label class="control-label col-md-2" for="title">Project Title / Program Name</label>
              <div class="col-md-10">
                <input type="text" name="title" class="form-control" id="title" required="true">
              </div>
          </div>
          <div class="form-group required">
            <label class="control-label col-md-2" for="name">Name of the Beneficiary / Coordinator</label>
            <div class="col-md-10">
              <input type="text" name="name" class="form-control" id="name" required="true">
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-2" for="organization">Name of Organization (if applicable)</label>
              <div class="col-md-10">
                <input type="text" name="organization" class="form-control" id="organization">
              </div>
          </div>
          <div class="form-group required">
            <label class="control-label col-md-2">Date of Project Implementation</label>
            <div class="col-md-10">
              <div class="row">
                <label class="control-label col-md-2" for="start">Start Date</label>
                <div class="col-md-10">
                  <input type="text" name="start" class="form-control" id="start" required="true">
                </div>
                <label class="control-label col-md-2" for="end">End Date</label>
                <div class="col-md-10">
                  <input type="text" name="end" class="form-control" id="end" required="true">
                </div>
              </div>
            </div>
          </div>
          <div class="form-group required">
            <label class="control-label col-md-2">Person responsible for grant Contact details</label>
            <div class="col-md-10">
              <div class="row">
                <label class="control-label col-md-2" for="contact-name">Name</label>
                <div class="col-md-10">
                  <input type="text" name="contact-name" class="form-control" id="contact-name" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-address">Address</label>
                <div class="col-md-10">
                  <input type="text" name="contact-address" class="form-control" id="contact-address" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-postal">Postal Code</label>
                <div class="col-md-10">
                  <input type="number" name="contact-postal" class="form-control" id="contact-postal" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-city">City</label>
                <div class="col-md-10">
                  <input type="text" name="contact-city" class="form-control" id="contact-city" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-country">Country</label>
                <div class="col-md-10">
                  <input type="text" name="contact-country" class="form-control" id="contact-country" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-email">E-mail</label>
                <div class="col-md-10">
                  <input type="email" name="contact-email" class="form-control" id="contact-email" required="true">
                </div>
                <label class="control-label col-md-2" for="contact-phone">Phone</label>
                <div class="col-md-10">
                  <input type="number" name="contact-phone" class="form-control" id="contact-phone" required="true">
                </div>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-md-2" for="website">Project Website</label>
            <div class="col-md-10">
              <input type="text" name="website" class="form-control" id="website" required="true">
            </div>
          </div>
          <hr>
          <div class="form-group">
            <label style="text-align: left" class="control-label col-md-12 text-left" for="fund-detail">Please provide details of how you used the funds received from the Wikimedia Indonesia.</label>
            <div class="col-md-12">
              <textarea name="fund-detail" class="form-control" rows="5" id="fund-detail" required="true"></textarea>
            </div>
          </div>
          <div class="form-group">
            <label style="text-align: left" class="control-label col-md-12" for="fund-progress">Please describe the progress you made in achieving the purposes for which the funds were provided and any lessons learned.</label>
            <div class="col-md-12">
              <textarea name="fund-progress" class="form-control" rows="5" id="fund-progress" required="true"></textarea>
            </div>
          </div>
          <div class="form-group">
            <label style="text-align: left" class="control-label col-md-12" for="comment">Is there anything else you would like to share?</label>
            <div class="col-md-12">
              <textarea name="comment" class="form-control" rows="5" id="comment" required="true"></textarea>
            </div>
          </div>
          <div class="form-group"> 
            <div class="col-md-10">
              <button type="submit" class="btn btn-default">Submit</button>
            </div>
          </div>
          </form>
        </div>
      </div>
    </div>
    <script>
      var obj = JSON.parse(userdata);
      window.netlifyIdentity.on("login", () => {
        document.getElementById("showform").style.display="block";
        document.getElementById("hideform").style.display = "none";
        document.getElementById("contact-name").value = obj.user_metadata.full_name;
        document.getElementById("contact-name").readOnly  = true;
        document.getElementById("contact-email").value = obj.email;
        document.getElementById("contact-email").readOnly  = true;
      });
    </script>
  </body>
</html>